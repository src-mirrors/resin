<document>
  <header>
    <product>resin</product>
    <resin-2.0>$resin/ref/ejb-jonas.xtp</resin-2.0>
    <title>JOnAS or Enhydra Enterprise EJB</title>
    <keywords>
      <keyword>enhydra</keyword>
    </keywords>
  </header>

  <body>
    <summary/>
    <s1 title="JOnAS or Enhydra Enterprise EJB">

<p>
From Pedro Costa:
</p>

<p>To use Resin as an EJB client with JOnAS or Enhydra Enterprise follow these steps:</p>

<ol>
<li>Under JOnAS or Enhydra do nothing

</li><li>Copy JEREMIE_jonas.jar (RMI_jonas.jar if you are using rmi and not
jeremie) into WEB-INF/lib or resin1.2/lib.

<p>If you are using JOnAS on the same machine as Resin you can do the same
by adding the following line to your app on resin.conf 
(assuming JOnAS is installed on \JONAS)

<example>
&lt;classpath id='/JONAS/lib/JEREMIE_jonas.jar'/&gt;
</example>

</p></li><li>Copy the EJB jar's file containing your beans to WEB-INF/lib
If you are using JOnAS on the same machine as Resin you can do the same
by adding the following line to your app on resin.conf 
(assuming JOnAS is installed on \JONAS and your beans are on a dir called \JONAS\mybeans)

<example>
&lt;classpath id='/JONAS/mybeans' source='/JONAS/mybeans' compile='false'/&gt;
</example>
        
</li><li>In resin.conf add these lines to your app (assuming you are using jeremie):

<example>
&lt;jndi-link&gt;
  &lt;jndi-name&gt;java:comp/env/ejb&lt;/jndi-name&gt;
  &lt;jndi-factory&gt;
    org.objectweb.jeremie.libs.services.registry.jndi.JRMIInitialContextFactory
  &lt;/jndi-factory&gt;
  &lt;init-param java.naming.provider.url="jrmi://YOUR_HOST:12340"/&gt;
  &lt;init-param java.naming.factory.url.pkgs="org.objectweb.jonas.naming"/&gt;
&lt;/jndi-link&gt;
</example>

</li><li>Don't forget to change YOUR_HOST to your hostname...
</li></ol>

<example title="Sample JSP showing how to access your beans">
&lt;!DOCTYPE html public "-//W3C//DTD HTML 4.0 Transitional//EN"&gt;
&lt;%@ page language="java"%&gt;
&lt;%@ page import="javax.naming.InitialContext" %&gt;
&lt;%@ page import="javax.naming.Context" %&gt;
&lt;%@ page import="javax.rmi.PortableRemoteObject" %&gt;
&lt;%@ page import="YOUR_BEANS_PACKAGE.*" %&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Test&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;%
  Context initialContext = new InitialContext();
  Object ref = initialContext.lookup("java:comp/env/ejb/ExpHome");
  ExpHome home = (ExpHome) PortableRemoteObject.narrow(ref, ExpHome.class);
  Exp t1 = home.create(); 
%&gt;
dummy result value = &lt;%=t1.dummyMethod()%&gt;
&lt;%
  t1.remove();    
%&gt;
&lt;/body&gt;
&lt;/html&gt;
</example>
</s1>
  </body>
</document>
